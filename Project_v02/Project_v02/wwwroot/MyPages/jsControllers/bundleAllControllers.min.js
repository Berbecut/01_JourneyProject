app.controller("chatController",function(n){n.chatPageControllerValue="my chat page";n.messages=[];var t=(new signalR.HubConnectionBuilder).withUrl("/chatHub").build();t.start();n.send=function(){var i=new Date,r=i.getHours()+":"+i.getMinutes()+":"+i.getSeconds();t.invoke("SendMessage",n.name,n.message,r)};t.on("ReceiveMessage",function(t,i,r){var u={name:t,message:i,time:r};n.messages.push(u);n.$apply()})});app.controller("getJourneysController",function(n,t,i,r){n.getJourneyControllerValue="my get journey page";t.get("/api/Journeys",{headers:{Authorization:"Bearer "+r.token}}).then(function(t){n.journeys=t.data});n.addSavedJourney=function(u){t.get("/api/Journeys"+u,{headers:{Authorization:"Bearer "+r.token}}).then(function(t){n.journey=t.data});i.path("/newJourney/"+u)};n.deleteJourney=function(i){t({method:"DELETE",url:"/api/Journeys/"+i.id}).then(function(){alert("Journeys has deleted Successfully");var t=n.journeys.indexOf(i);n.journeys.splice(t,1)},function(){alert("Error while deleting journey. Try Again!")})}});app.controller("loginController",function(n,t,i,r){n.loginPageControllerValue="my login page";n.$watch("emailModel",function(){n.emailModel!=""&&(n.emptyEmailError=!1)});n.$watch("passModel",function(){n.passModel!=""&&(n.emptyPasswordError=!1)});n.$watch("showMessage",function(){n.showMessage=!0});n.loginUser=function(){if(n.emailModel==null||n.emailModel=="")n.emptyEmailError=!0;else if(n.passModel==null||n.passModel=="")n.emptyPasswordError=!0;else if(n.passModel==null||n.passModel=="")n.showMessage=!0;else{let u={Email:n.emailModel,Password:n.passModel};t.post("/api/Users",u).then(function(n){i.token=n.data.token;i.email=n.data.email;r.path("/userConnected")})}}});app.controller("manageVehicleController",["$scope","$http",function(n,t){n.submit=!0;n.update=!1;n.cancel=!1;n.vehicleid=!0;t({method:"GET",url:"/api/Vehicles"}).then(function(t){n.vehicles=t.data},function(){alert("Error. Try Again!")});n.createVehicle=function(){t({method:"POST",url:"/api/Vehicles",data:n.vehicle}).then(function(t){n.vehicles.push(t.data);alert("Vehicle has created Successfully")},function(){alert("Error while created vehicle. Try Again!")})};n.updateVehicle=function(){t({method:"PUT",url:"/api/Vehicles/"+n.vehicle.id,data:n.vehicle}).then(function(){t({method:"GET",url:"/api/Vehicles"}).then(function(t){n.vehicles=t.data},function(){alert("Error. Try Again!")});alert("Vehicle has updated Successfully")},function(){alert("Error while updating vehicle. Try Again!")})};n.deleteVehicle=function(i){t({method:"DELETE",url:"/api/Vehicles/"+i.id}).then(function(){alert("Vehicle has deleted Successfully");var t=n.vehicles.indexOf(i);n.vehicles.splice(t,1)},function(){alert("Error while deleting vehicle. Try Again!")})};n.editVehicle=function(t){n.vehicle=t;n.submit=!1;n.update=!0;n.cancel=!0;n.vehicleid=!1};n.cancelUpdate=function(){n.vehicle=null;n.submit=!0;n.update=!1;n.cancel=!1;n.vehicleid=!0}}]);app.controller("navBarConnectedController",function(n,t,i){n.navBarPageControllerValue="Florin";n.signOutFunction=function(){t.email="";i.path("/")}});app.controller("navBarController",function(n){n.navBarPageControllerValue="Florin"});app.controller("newJourneyController",function(n,t,i,r){n.newJourneyPageControllerValue="my new journey page";n.dateTime=new Date;let u=r.id;n.id=u;n.id||(n.id=0);t.get("api/Journeys/"+u).then(function(t){let i=t.data;n.dateTime=new Date(i.dateTime);n.start=i.meterStart;n.stop=i.meterStop;n.Citystart=i.locationStart.city;n.Startaddress=i.locationStart.streetName;n.Startno=i.locationStart.streetNumber;n.Citystop=i.locationStop.city;n.Endaddress=i.locationStop.streetName;n.Endno=i.locationStop.streetNumber;n.case=i.case;n.Notes=i.note;n.selectVehicle=i.vehicle.licensePlate});n.$watch("start",function(){n.start!=""&&(n.startError=!1)});n.$watch("stop",function(){n.stop!=""&&(n.stopError=!1)});n.$watch("stop - start",function(){n.stop<n.start&&(n.stopErrorNegative=!1)});n.$watch("Citystart",function(){n.Citystart!=""&&(n.startCityError=!1)});n.$watch("Startaddress",function(){n.Startaddress!=""&&(n.startAddressError=!1)});n.$watch("Startno",function(){n.Startno!=""&&(n.startNumberError=!1)});n.$watch("Citystop",function(){n.Citystop!=""&&(n.stopCityError=!1)});n.$watch("Endaddress",function(){n.Endaddress!=""&&(n.stopAddressError=!1)});n.$watch("Endno",function(){n.Endno!=""&&(n.stopNumberError=!1)});n.$watch("case",function(){n.case!=""&&(n.caseError=!1)});n.$watch("selectVehicle",function(){n.selectVehicle!=""&&(n.selectVehicleError=!1,t.get("/api/partialJourneys").then(function(t){n.journeys=t.data;angular.forEach(t.data,function(t){t.vehicle.licensePlate==n.selectVehicle&&(n.selectVehicleError=!0);console.log(t.vehicle.licensePlate)})}))});n.savePartialJourney=function(){if(n.start==0||n.start==null||n.start=="")n.startError=!0;else if(n.Citystart==null||n.Citystart=="")n.startCityError=!0;else if(n.Startaddress==null||n.Startaddress=="")n.startAddressError=!0;else if(n.Startno==null||n.Startno=="")n.startNumberError=!0;else{let r={LicensePlate:n.selectVehicle,DateTime:n.dateTime.toISOString(),MeterStart:n.start,CityStart:n.Citystart,StartAddress:n.Startaddress,StartNo:n.Startno};t.post("/api/Journeys",r).then(function(t){n.journey=t.data;i.path("/userConnected")});t.get("/api/Journeys").then(function(t){n.journey=t.data})}};n.saveJourney=function(){if(n.start==0||n.start==null||n.start=="")n.startError=!0;else if(n.stop==0||n.stop==null||n.stop=="")n.stopError=!0;else if(n.stop<n.start)n.stopErrorNegative=!0;else if(n.Citystart==null||n.Citystart=="")n.startCityError=!0;else if(n.Startaddress==null||n.Startaddress=="")n.startAddressError=!0;else if(n.Startno==null||n.Startno=="")n.startNumberError=!0;else if(n.Citystop==null||n.Citystop=="")n.stopCityError=!0;else if(n.Endaddress==null||n.Endaddress=="")n.stopAddressError=!0;else if(n.Endno==null||n.Endno=="")n.stopNumberError=!0;else if(n.case==null||n.case=="")n.caseError=!0;else{let r={LicensePlate:n.selectVehicle,DateTime:n.dateTime,MeterStart:n.start,MeterStop:n.stop,TotalLength:n.stop-n.start,CityStart:n.Citystart,CityStop:n.Citystop,StartAddress:n.Startaddress,EndAddress:n.Endaddress,StartNo:n.Startno,EndNo:n.Endno,Case:n.case,Note:n.Notes};n.id==""||typeof n.id=="undefined"?t.post("/api/Journeys",r).then(function(t){n.journey=t.data;i.path("/userConnected")}):t.put("/api/Journeys/"+n.id,r).then(function(t){n.journey=t.data;i.path("/userConnected")})}t.get("/api/Journeys").then(function(t){n.journey=t.data})};t({method:"GET",url:"/api/Vehicles"}).then(function(t){n.vehicles=t.data;angular.forEach(n.vehicles,function(t){t.active&&(n.selectVehicle=t.licensePlate)})},function(){alert("Error. Try Again!")});n.findStartAddress=function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){n.latitude=t.coords.latitude;n.longitude=t.coords.longitude;n.$apply();var i=new google.maps.Geocoder,r={lat:parseFloat(n.latitude),lng:parseFloat(n.longitude)};i.geocode({location:r},function(t,i){console.log(i);console.log(t);t[0]&&t[0].address_components.forEach(function(t){t.types[0]=="street_number"&&(n.Startno=t.long_name,n.$apply());t.types[0]=="route"&&(n.Startaddress=t.long_name,n.$apply());t.types[0]=="postal_town"&&(n.Citystart=t.long_name,n.$apply())})});console.log(t)},function(){n.latitude=57.396426;n.longitude=14.673131}):(n.latitude=57.396426,n.longitude=14.673131)};n.findStopAddress=function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){n.latitude=t.coords.latitude;n.longitude=t.coords.longitude;n.$apply();var i=new google.maps.Geocoder,r={lat:parseFloat(n.latitude),lng:parseFloat(n.longitude)};i.geocode({location:r},function(t,i){console.log(i);console.log(t);t[0]&&t[0].address_components.forEach(function(t){t.types[0]=="street_number"&&(n.Endno=t.long_name,n.$apply());t.types[0]=="route"&&(n.Endaddress=t.long_name,n.$apply());t.types[0]=="postal_town"&&(n.Citystop=t.long_name,n.$apply())})});console.log(t)},function(){n.latitude=57.396426;n.longitude=14.673131}):(n.latitude=57.396426,n.longitude=14.673131)}});app.controller("newUserController",function(n,t,i){n.newUserPageControllerValue="my new user page F";n.$watch("firstNameModel",function(){n.firstNameModel!=""&&(n.firstNameError=!1)});n.$watch("lastNameModel",function(){n.lastNameModel!=""&&(n.lastNameError=!1)});n.$watch("emailModel",function(){n.emailModel!=""&&(n.emptyEmailError=!1)});n.$watch("passModel",function(){n.passModel!=""&&(n.emptyPasswordError=!1)});n.saveNewUser=function(){if(n.firstNameModel==null||n.firstNameModel=="")n.firstNameError=!0;else if(n.lastNameModel==null||n.lastNameModel=="")n.lastNameError=!0;else if(n.emailModel==null||n.emailModel=="")n.emptyEmailError=!0;else if(n.passModel==null||n.passModel=="")n.emptyPasswordError=!0;else{let r={FirstName:n.firstNameModel,LastName:n.lastNameModel,Email:n.emailModel,Password:n.passModel};t.post("/register",r).then(function(t){n.errors=t.data.errors;t.data.succeeded&&(i.path("/"),n.firstNameModel="",n.lastNameModel="",n.email="",n.password="");console.log(t)});t.get("/api/Users").then(function(t){n.user=t.data})}}});app.controller("pdfController",function(n){n.pdfPageControllerValue="my pdf page"});app.controller("recoverPasswordController",function(n){n.recoverPasswordPageControllerValue="my recover password page"});app.controller("reportController",function(n,t,i){n.reportPageControllerValue="my report page";t({method:"GET",url:"/api/Vehicles"}).then(function(t){n.vehicles=t.data},function(){alert("Error. Try Again!")});n.$watch("selectVehicle",function(){n.selectVehicle!=""&&(n.startSelectError=!1)});n.$watch("dateStartReport",function(){n.dateStartReport!=""&&(n.startError=!1)});n.$watch("dateEndReport",function(){n.dateEndReport!=""&&(n.endError=!1)});n.createReport=function(){if(n.selectVehicle==0||n.selectVehicle==null||n.selectVehicle=="")n.startSelectError=!0;else if(n.dateStartReport==0||n.dateStartReport==null||n.dateStartReport=="")n.startError=!0;else if(n.dateEndReport==0||n.dateEndReport==null||n.dateEndReport=="")n.endError=!0;else{let i={LicensePlate:n.selectVehicle,DateTimeStart:n.dateStartReport.toISOString(),DateTimeStop:n.dateEndReport.toISOString()};t.post("/api/report",i).then(function(t){n.data=t.data;n.labels=["0-20km","21-50km","51-200km"];n.options={legend:{display:!0,position:"bottom"},tooltipEvents:[],showTooltips:!0,tooltipCaretSize:0,onAnimationComplete:function(){this.showTooltip(this.segments,!0)}}})}};n.createPdf=function(){if(n.selectVehicle==0||n.selectVehicle==null||n.selectVehicle=="")n.startSelectError=!0;else if(n.dateStartReport==0||n.dateStartReport==null||n.dateStartReport=="")n.startError=!0;else if(n.dateEndReport==0||n.dateEndReport==null||n.dateEndReport=="")n.endError=!0;else{let r={LicensePlate:n.selectVehicle,DateTimeStart:n.dateStartReport.toISOString(),DateTimeStop:n.dateEndReport.toISOString()};t.post("/api/pdf",r).then(function(){i.open("/MyPages/pdf/"+n.selectVehicle+".pdf","_blank")})}}});app.controller("userConnectedController",function(n,t,i){n.userPageControllerValue="my connected page";t.get("/api/partialJourneys").then(function(t){n.journeys=t.data});n.addUnsavedJourney=function(n){i.path("/newJourney/"+n)}});